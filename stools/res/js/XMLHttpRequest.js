(function(){function e(){this._object=a&&!d?new a:new window.ActiveXObject("Microsoft.XMLHTTP");this._listeners=[]}function f(){return new e}function g(a){a._object.send(a._data);if(b&&!a._async){a.readyState=f.OPENED;j(a);while(a.readyState<f.DONE){a.readyState++;h(a);if(a._aborted){return}}}}function h(a){if(f.onreadystatechange){f.onreadystatechange.apply(a)}a.dispatchEvent({type:"readystatechange",bubbles:false,cancelable:false,timeStamp:new Date+0})}function i(a){var b=a.responseXML;var d=a.responseText;if(c&&d&&b&&!b.documentElement&&a.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){b=new window.ActiveXObject("Microsoft.XMLDOM");b.async=false;b.validateOnParse=false;b.loadXML(d)}if(b){if(c&&b.parseError!==0||!b.documentElement||b.documentElement&&b.documentElement.tagName=="parsererror"){return null}}return b}function j(a){try{a.responseText=a._object.responseText}catch(b){}try{a.responseXML=i(a._object)}catch(b){}try{a.status=a._object.status}catch(b){}try{a.statusText=a._object.statusText}catch(b){}}function k(a){a._object.onreadystatechange=new window.Function}var a=window.XMLHttpRequest;var b=!!window.controllers;var c=window.document.all&&!window.opera;var d=c&&window.navigator.userAgent.match(/MSIE 7.0/);f.prototype=e.prototype;if(b&&a.wrapped){f.wrapped=a.wrapped}f.UNSENT=0;f.OPENED=1;f.HEADERS_RECEIVED=2;f.LOADING=3;f.DONE=4;f.prototype.UNSENT=f.UNSENT;f.prototype.OPENED=f.OPENED;f.prototype.HEADERS_RECEIVED=f.HEADERS_RECEIVED;f.prototype.LOADING=f.LOADING;f.prototype.DONE=f.DONE;f.prototype.readyState=f.UNSENT;f.prototype.responseText="";f.prototype.responseXML=null;f.prototype.status=0;f.prototype.statusText="";f.prototype.priority="NORMAL";f.prototype.onreadystatechange=null;f.onreadystatechange=null;f.onopen=null;f.onsend=null;f.onabort=null;f.prototype.open=function(a,d,e,g,i){var l=a.toLowerCase();if(l=="connect"||l=="trace"||l=="track"){throw new Error(18)}delete this._headers;if(arguments.length<3){e=true}this._async=e;var m=this;var n=this.readyState;var o=null;if(c&&e){o=function(){if(n!=f.DONE){k(m);m.abort()}};window.attachEvent("onunload",o)}if(f.onopen){f.onopen.apply(this,arguments)}if(arguments.length>4){this._object.open(a,d,e,g,i)}else if(arguments.length>3){this._object.open(a,d,e,g)}else{this._object.open(a,d,e)}this.readyState=f.OPENED;h(this);this._object.onreadystatechange=function(){if(b&&!e){return}m.readyState=m._object.readyState;j(m);if(m._aborted){m.readyState=f.UNSENT;return}if(m.readyState==f.DONE){delete m._data;k(m);if(c&&e){window.detachEvent("onunload",o)}if(n!=m.readyState){h(m)}n=m.readyState}}};f.prototype.send=function(a){if(f.onsend){f.onsend.apply(this,arguments)}if(!arguments.length){a=null}if(a&&a.nodeType){a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._data=a;g(this)};f.prototype.abort=function(){if(f.onabort){f.onabort.apply(this,arguments)}if(this.readyState>f.UNSENT){this._aborted=true}this._object.abort();k(this);this.readyState=f.UNSENT;delete this._data};f.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};f.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)};f.prototype.setRequestHeader=function(a,b){if(!this._headers){this._headers={}}this._headers[a]=b;return this._object.setRequestHeader(a,b)};f.prototype.addEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++){if(e[0]==a&&e[1]==b&&e[2]==c){return}}this._listeners.push([a,b,c])};f.prototype.removeEventListener=function(a,b,c){for(var d=0,e;e=this._listeners[d];d++){if(e[0]==a&&e[1]==b&&e[2]==c){break}}if(e){this._listeners.splice(d,1)}};f.prototype.dispatchEvent=function(a){var b={type:a.type,target:this,currentTarget:this,eventPhase:2,bubbles:a.bubbles,cancelable:a.cancelable,timeStamp:a.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};if(b.type=="readystatechange"&&this.onreadystatechange){(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[b])}for(var c=0,d;d=this._listeners[c];c++){if(d[0]==b.type&&!d[2]){(d[1].handleEvent||d[1]).apply(this,[b])}}};f.prototype.toString=function(){return"["+"object"+" "+"XMLHttpRequest"+"]"};f.toString=function(){return"["+"XMLHttpRequest"+"]"};if(!window.Function.prototype.apply){window.Function.prototype.apply=function(a,b){if(!b){b=[]}a.__func=this;a.__func(b[0],b[1],b[2],b[3],b[4]);delete a.__func}}window.XMLHttpRequest=f})()
